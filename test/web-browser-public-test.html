<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8"> 
<meta http-equiv="X-UA-Compatible" content="IE=Edge, Chrome=1">
<meta http-equiv="Content-Language" content="ja">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
</head>
<body>

<!--script src="http://lightspeedworks.github.io/get-constructors/get-constructors.js"></script-->
<script src="../node_modules/get-constructors/get-constructors.js"></script>
<!--script src="http://lightspeedworks.github.io/base-class-extend/lib/base-class-extend.js"></script-->
<script src="../lib/base-class-extend.js"></script>

<script>
(function () {
  // Array.prototype.map for ie8
  if (!Array.prototype.hasOwnProperty('map'))
    Array.prototype.map = function map(fn, ctx) {
      var n = this.length, res = new Array(n);
      for (var i = 0; i < n; ++i)
        res[i] = fn.call(ctx, this[i], i, this);
      return res;
    };

  // console.log redefine for web browser test.
  var logOrg = console.log;
  console.log = function logNew() {
    logOrg.apply(console, arguments);
    document.writeln([].slice.call(arguments).join(' ') + '<br/>');
  };
  console.log('new console.log has defined for web browser test.');

  var rex = /^[AIUEO]/i;
  function a(s) { return rex.exec(s) ? 'an ' + s : 'a ' + s; }

  console.log();
  console.log('BaseClass.extend defines Animal class.');
  var Animal = BaseClass.extend({
    constructor: function Animal(name) {
      this.name = name;
    },
    introduce: function introduce() {
      console.log('My name is ' + this.name + '. ' +
                  'I am ' + a(this.constructor.name) + '.');
      console.log('私の名前は' + this.name + 'です。' +
                  '私は' + this.constructor.name + 'です。');
    }
  });

  console.log('Animal creates instance.');
  var a1 = new Animal('Annie');
  a1.introduce();
  console.log(constructors(Animal).map(nm).join(' < '), ': Animal');
  console.log(constructors(a1    ).map(nm).join(' < '), ': a1');


  console.log();
  console.log('Animal.extend defines Bear class.');
  var Bear = Animal.extend('Bear');

  console.log('Bear creates instance.');
  var b1 = Bear('Pooh');
  b1.introduce();
  console.log(constructors(Bear).map(nm).join(' < '), ': Bear');
  console.log(constructors(b1  ).map(nm).join(' < '), ': b1');


  console.log();
  console.log('BaseClass.extend defines Klass class.');
  var Klass = BaseClass.extend('Klass');

  console.log('Klass creates instances.');
  var k1 = new Klass();
  var k2 = Klass.create();
  var k2 = Klass['new']();
  var k3 = Klass();
  console.log(constructors(Klass).map(nm).join(' < '), ': Klass');
  console.log(constructors(k1   ).map(nm).join(' < '), ': k1');
  console.log(constructors(k2   ).map(nm).join(' < '), ': k2');
  console.log(constructors(k3   ).map(nm).join(' < '), ': k3');

  function nm(e) { return e.name; }
})();
</script>

</body>
</html>
